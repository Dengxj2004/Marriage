# ORCID女性姓名变化检测程序

## 核心逻辑

### 性别筛选
- 使用`gender-guesser`库识别性别
- 仅保留`female` + `mostly_female`

### 姓名变化检测
**两种变化模式**:
1. **加中间名**: `Jane Smith` → `Jane Smith Johnson`
2. **改姓**: `Jane Smith` → `Jane Johnson`

**关键判断条件**:
- 包含原姓氏或名字
- 名字部分相同 (同一人确认)  
- 时间先后顺序合理
- 排除缩写情况 (`J. Smith`)

### 输出格式
```csv
port_name,id,s_name,first_date,o_name,last_modified_date,gender
```

## 算法细节

### XML解析流程
1. 提取`person:name`基本信息
2. 获取`other-name:other-name`变更信息  
3. 提取时间戳进行比对
4. 性别识别过滤

### 姓名匹配逻辑
1. **预处理**: 小写化 + 去标点 + 空格标准化
2. **关联性**: 检查姓氏/名字包含关系
3. **时间序**: 确保修改时间合理性
4. **模式识别**: 
   - 有共同姓氏 → 加中间名检测
   - 无共同姓氏 → 改姓检测
   - 排除缩写 → 避免误判

## 2025-08-13修改

### 数据提取逻辑
- 改用`person:name`的`given-names` + `family-name`作为基准姓名，不使用`source-name`
- 支持处理多个`other-name:other-name`标签
- 提取`created-date`而非`last-modified-date`进行时间比较
- 引入 Levenshtein 距离算法，替换原有的严格相等（==）判断，以实现对姓名拼写错误的容错处理。


### 时间判断条件
- 时间差要求从"日期不同"改为"相差30天以上"

### 姓名变化检测优化
- 修正加中间名误判：检查最后一个姓氏是否改变
- `anna smith` → `anna adam smith`不再被识别为姓氏变化
- `anna smith` → `anna adam johnson`正确识别为改姓



